from openpyxl import Workbook
from pathlib import Path
import tempfile

def export_file(table, class_name):
    # OS-unabhängiges temp-Verzeichnis
    temp_dir = Path(tempfile.gettempdir())

    # Speicherdatei (z.B. /tmp/02TSFR_klassenliste.xlsx)
    output_file = temp_dir / f"{class_name}_klassenliste.xlsx"

    wb = Workbook()
    ws = wb.active

    # Header
    ws.append(list(table[0].keys()))

    # Rows
    for row in table:
        ws.append(list(row.values()))

    wb.save(output_file)

    # Rückgabe: absoluter Pfad als String
    return str(output_file)

#export_file('{"Lv-Id": "301600", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "0.167", "Fach": "BAPII", "Lehrer": "SCTH", "Periodizit\u00e4t": "1.Hj BAPII", "Klasse(n)": "02TSAP,02TSFR,10ELH", "Sch\u00fclergruppe": "None", "Fix (X)": "None", "Bis": "None", "Von": "None", "comment": "gekoppelt mit 02TSAP, 10ELH"}, {"Lv-Id": "301600", "WoStd_SuS": "None", "Wert": "None", "WoStd_KuK": "0.167", "Fach": "BAPII", "Lehrer": "MAYM", "Periodizit\u00e4t": "1.Hj BAPII", "Klasse(n)": "02TSAP,02TSFR,10ELH", "Sch\u00fclergruppe": "None", "Fix (X)": "None", "Bis": "None", "Von": "None", "comment": "gekoppelt mit 02TSAP, 10ELH"}, {"Lv-Id": "517300", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "0.25", "Fach": "BAPII", "Lehrer": "SCTH", "Periodizit\u00e4t": "1.Hj BAPII", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "None", "Fix (X)": "None", "Bis": "None", "Von": "None", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "517300", "WoStd_SuS": "None", "Wert": "None", "WoStd_KuK": "0.25", "Fach": "BAPII", "Lehrer": "MAYM", "Periodizit\u00e4t": "1.Hj BAPII", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "None", "Fix (X)": "None", "Bis": "None", "Von": "None", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "126600", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "0.263", "Fach": "Deu", "Lehrer": "NIEA", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "None", "Fix (X)": "None", "Bis": "2025-11-09 00:00:00", "Von": "None", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "570200", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "0.237", "Fach": "Deu", "Lehrer": "ROHN", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "02TS_Deu_ROHN", "Fix (X)": "None", "Bis": "None", "Von": "2025-11-10 00:00:00", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "519400", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "0.5", "Fach": "Eng", "Lehrer": "NIES", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "NIES_02_A", "Fix (X)": "None", "Bis": "None", "Von": "None", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "519500", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "0.5", "Fach": "Eng", "Lehrer": "NIES", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "NIES_02_B", "Fix (X)": "None", "Bis": "None", "Von": "None", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "398900", "WoStd_SuS": "4", "Wert": "None", "WoStd_KuK": "2", "Fach": "LF10", "Lehrer": "HEUS", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSFR", "Sch\u00fclergruppe": "None", "Fix (X)": "None", "Bis": "None", "Von": "None"}, {"Lv-Id": "398900", "WoStd_SuS": "4", "Wert": "None", "WoStd_KuK": "0.947", "Fach": "LF10", "Lehrer": "HEUS", "Periodizit\u00e4t": "1.Hj1.H\u00e4l", "Klasse(n)": "02TSFR", "Sch\u00fclergruppe": "None", "Fix (X)": "None", "Bis": "None", "Von": "None"}, {"Lv-Id": "397900", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "1", "Fach": "LF3", "Lehrer": "REHU", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSFR", "Sch\u00fclergruppe": "None", "Fix (X)": "None", "Bis": "None", "Von": "None"}, {"Lv-Id": "520600", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "1", "Fach": "LF6", "Lehrer": "KLUA", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSFR", "Sch\u00fclergruppe": "02FR_LF6_KLUA", "Fix (X)": "None", "Bis": "None", "Von": "None"}, {"Lv-Id": "513000", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "1", "Fach": "LF6", "Lehrer": "LAND", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSFR", "Sch\u00fclergruppe": "02FR_LF6_LAND", "Fix (X)": "None", "Bis": "None", "Von": "None"}, {"Lv-Id": "513000", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "1", "Fach": "LF6", "Lehrer": "LAND", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSFR", "Sch\u00fclergruppe": "02FR_LF6_LAND", "Fix (X)": "None", "Bis": "None", "Von": "None"}, {"Lv-Id": "520800", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "1", "Fach": "LF7", "Lehrer": "BLEJ", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSFR", "Sch\u00fclergruppe": "02FR_LF7_BLEJ", "Fix (X)": "None", "Bis": "None", "Von": "None"}, {"Lv-Id": "513200", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "1", "Fach": "LF7", "Lehrer": "GEIM", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSFR", "Sch\u00fclergruppe": "02FR_LF7_GEIM", "Fix (X)": "None", "Bis": "None", "Von": "None"}, {"Lv-Id": "200400", "WoStd_SuS": "4", "Wert": "None", "WoStd_KuK": "2", "Fach": "LF8", "Lehrer": "FEYH", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSFR", "Sch\u00fclergruppe": "None", "Fix (X)": "None", "Bis": "None", "Von": "None"}, {"Lv-Id": "213600", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "1", "Fach": "LF9", "Lehrer": "BOCJ", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSFR", "Sch\u00fclergruppe": "None", "Fix (X)": "None", "Bis": "None", "Von": "None"}, {"Lv-Id": "519700", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "0.079", "Fach": "Ma-FH", "Lehrer": "SCTH", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "Gr.MaFH", "Fix (X)": "None", "Bis": "2025-09-07 00:00:00", "Von": "None", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "519700", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "0.158", "Fach": "Ma-FH", "Lehrer": "SCTH", "Periodizit\u00e4t": "A-Wo GSEF 1.Hj", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "Gr.MaFH", "Fix (X)": "None", "Bis": "None", "Von": "2025-09-08 00:00:00", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "519700", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "0.132", "Fach": "Ma-FH", "Lehrer": "SCTH", "Periodizit\u00e4t": "B-Wo GSEF 1.Hj", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "Gr.MaFH", "Fix (X)": "None", "Bis": "None", "Von": "2025-09-08 00:00:00", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "519700", "WoStd_SuS": "None", "Wert": "None", "WoStd_KuK": "0.132", "Fach": "Ma-FH", "Lehrer": "SCTH", "Periodizit\u00e4t": "C-Wo GSEF 1.Hj", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "Gr.MaFH", "Fix (X)": "None", "Bis": "None", "Von": "None", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "518900", "WoStd_SuS": "4", "Wert": "None", "WoStd_KuK": "0.263", "Fach": "Proj", "Lehrer": "LAND", "Periodizit\u00e4t": "1.Hj2.H\u00e4l", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "Gr.02LAND", "Fix (X)": "None", "Bis": "None", "Von": "None", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "518800", "WoStd_SuS": "None", "Wert": "None", "WoStd_KuK": "0.263", "Fach": "Proj", "Lehrer": "CLAM", "Periodizit\u00e4t": "1.Hj2.H\u00e4l", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "Gr.02CLAM", "Fix (X)": "None", "Bis": "None", "Von": "None", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "519000", "WoStd_SuS": "None", "Wert": "None", "WoStd_KuK": "0.263", "Fach": "Proj", "Lehrer": "FEYH", "Periodizit\u00e4t": "1.Hj2.H\u00e4l", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "Gr.02FEYH", "Fix (X)": "None", "Bis": "None", "Von": "None", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "509000", "WoStd_SuS": "None", "Wert": "None", "WoStd_KuK": "0.263", "Fach": "Proj", "Lehrer": "GEIM", "Periodizit\u00e4t": "1.Hj2.H\u00e4l", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "Gr.02GEIM", "Fix (X)": "None", "Bis": "None", "Von": "None", "comment": "gekoppelt mit 02TSAP"}, {"Lv-Id": "519900", "WoStd_SuS": "2", "Wert": "None", "WoStd_KuK": "0.5", "Fach": "UnEx", "Lehrer": "SCKA", "Periodizit\u00e4t": "1.Hj", "Klasse(n)": "02TSAP,02TSFR", "Sch\u00fclergruppe": "Gr.UnEx", "Fix (X)": "None", "Bis": "None", "Von": "None", "comment": "gekoppelt mit 02TSAP"}', "02TSFR")